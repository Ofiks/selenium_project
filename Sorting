'''
MVP версия автоматизированного тестирования функции выставления сортировки товаров по возрастанию и по убыванию.
Это не окончательная версия, планируется последующая разработка
Исходная страница - https://kolobokshop.ru/?orderby=price&paged=1&product_cat=snowflow
Код выполняется на python + selenium, pytest, time, re
Посмотреть реализацию - https://drive.google.com/file/d/17v0UZ1h3G6qkyNnxG850wGWqeF_E9nqb/view?usp=drive_link
'''

from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import re
from time import sleep

driver = webdriver.Chrome()
driver.get("https://kolobokshop.ru/?orderby=price&paged=1&product_cat=snowflow")
#получение цен по тегу
price = driver.find_elements(By.TAG_NAME, 'bdi')

#отсечение символа рубля и копеек
lst = [x.text[0:-5] for x in price]
lst1 = []
for ed in lst:
    if ed != '':
        lst1.append(ed)

#убирание пробела и перевод строк в числа
mp = list(map(lambda x: int(re.sub(' ', '', x)), lst1))
print(mp)
srt = sorted(mp)
print(srt)
if mp == srt:
    print('числа расположены по возрастанию ☺')
else:
    print('ошибка')

el = driver.find_element(By.CLASS_NAME, 'orderby')
el.click()
el = driver.find_element(By.XPATH, "//*[text()='По возрастанию цены']")
el.click()
sleep(10)

#получение цен по тегу
price = driver.find_elements(By.TAG_NAME, 'bdi')

#отсечение символа рубля и копеек
lst = [x.text[0:-5] for x in price]
lst1 = []
for ed in lst:
    if ed != '':
        lst1.append(ed)

#убирание пробела и перевод строк в числа
mp = list(map(lambda x: int(re.sub(' ', '', x)), lst1))
print(mp)
srt = sorted(mp)
print(srt)

def test_up():
    assert mp == srt


#установка цены по убыванию в выпадающем списке

el = driver.find_element(By.CLASS_NAME, 'orderby')
el.click()
el = driver.find_element(By.XPATH, "//*[text()='По убыванию цены']")
el.click()
sleep(5)

#получение цен по тегу
price = driver.find_elements(By.TAG_NAME, 'bdi')

#отсечение символа рубля и копеек
lst = [x.text[0:-5] for x in price]
lst1 = []
for ed in lst:
    if ed != '':
        lst1.append(ed)

#убирание пробела и перевод строк в числа
mp = list(map(lambda x: int(re.sub(' ', '', x)), lst1))
print(mp)
srt = sorted(mp, reverse=True)
print(srt)

def test_down():
    assert mp == srt
